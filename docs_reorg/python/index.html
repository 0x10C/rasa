
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Python API &#8212; Rasa NLU 0.13.0a1 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/banner.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex/" />
    <link rel="search" title="Search" href="../search/" />
    <link rel="next" title="Storing Models in the Cloud" href="../persist/" />
    <link rel="prev" title="HTTP API" href="../http/" />
   
  <!--<link rel="stylesheet" href="../_static/custom.css" type="text/css" />-->
  <link rel="stylesheet" href="../_static/xq-light.css" type="text/css" />
  <link rel="stylesheet" href="../_static/fontawesome/css/fontawesome-all.css" type="text/css" />
  <script defer type="text/javascript" src="../_static/config.js"></script>
  <script defer type="text/javascript" src="../_static/klaro.js"></script>
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>

<div class="nav-top">
  <h1 class="brand">
      <img src="/_static/rasa_logo.svg" width="80px" height="40px" title="Rasa" alt="Rasa logo">
  </h1>
  <span class="logo extension">docs</span>
  
  <ul class="nav">
    
      
        <li><a href=https://newdocs.rasa.com/about>About</a></li>
      
    
      
        <li class="active"><a href=https://newdocs.rasa.com/nlu>NLU</a></li>
      
    
      
        <li><a href=https://newdocs.rasa.com/core>Core</a></li>
      
    
      
        <li><a href=https://newdocs.rasa.com/platform>Platform</a></li>
      
    
    
    <li>
      <a href="https://www.github.com/RasaHQ" target="_blank"><button class="button btn-ghost btn-small"><i class="fab fa-github"></i>GitHub</button></a>
    </li>
    
  </ul>
</div>


  <div class="document">
    
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation/">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/">Quickstart</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../choosing_pipeline/">Choosing a Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../entities/">Entity Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../languages/">Language Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../evaluation/">Evaluating and Improving Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fallback/">Confidence and Fallback Intents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/">Frequently Asked Questions</a></li>
</ul>
<p class="caption"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../dataformat/">Training Data Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pipeline/">Pipeline and Component Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../config/">Server Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../http/">HTTP API</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../persist/">Storing Models in the Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docker/">Running in Docker</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../customcomponents/">Custom Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../migrations/">Migration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license/">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog/">Change Log</a></li>
</ul>

<div class="versions">
    <div>
      <span class="current-version">
        v: docs_reorg
      </span>
    </div>
    <div class="other-versions">
        <div class="dropdown">
          <button class="dropdown-btn">tags</button>
          <div class="dropdown-content">
              <a href="../0.12.3/python.html">0.12.3</a>
              <a href="../0.12.2/python.html">0.12.2</a>
              <a href="../0.12.1/python.html">0.12.1</a>
              <a href="../0.12.0/python.html">0.12.0</a>
              <a href="../0.11.4/python.html">0.11.4</a>
              <a href="../0.10.6/python.html">0.10.6</a>
              <a href="../0.9.2/python.html">0.9.2</a>
              <a href="../0.8.12/python.html">0.8.12</a>
              <a href="../0.7.4/python.html">0.7.4</a>
          </div>
        </div>
        <div class="dropdown">
          <button class="dropdown-btn">tags</button>
          <div class="dropdown-content">
              <a href="python.html">docs_reorg</a>
              <a href="../master/python.html">master</a>
          </div>
        </div>
    </div>
</div>


        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  


    
    



    <p class="scv-banner"><a href="../0.12.3/python.html"><b>Warning:</b> This document is for the development version of Rasa NLU. The latest version is 0.12.3.</a></p>
<div class="section" id="python-api">
<span id="section-python"></span><h1>Python API<a class="headerlink" href="#python-api" title="Permalink to this headline">¶</a></h1>
<p>Apart from running Rasa NLU as a HTTP server you can use it directly in your python program.
Rasa NLU supports both Python 2 and 3.</p>
<div class="section" id="training-a-model">
<h2>Training a Model<a class="headerlink" href="#training-a-model" title="Permalink to this headline">¶</a></h2>
<p>For creating your models, you can follow the same instructions as non-python users.
Or, you can train directly in python with a script like the following (using spacy):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rasa_nlu.training_data</span> <span class="kn">import</span> <span class="n">load_data</span>
<span class="kn">from</span> <span class="nn">rasa_nlu.model</span> <span class="kn">import</span> <span class="n">Trainer</span>
<span class="kn">from</span> <span class="nn">rasa_nlu</span> <span class="kn">import</span> <span class="n">config</span>

<span class="n">training_data</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="s1">&#39;data/examples/rasa/demo-rasa.json&#39;</span><span class="p">)</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;sample_configs/config_spacy.yml&quot;</span><span class="p">))</span>
<span class="n">trainer</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">training_data</span><span class="p">)</span>
<span class="n">model_directory</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">persist</span><span class="p">(</span><span class="s1">&#39;./projects/default/&#39;</span><span class="p">)</span>  <span class="c1"># Returns the directory the model is stored in</span>
</pre></div>
</div>
</div>
<div class="section" id="using-a-model-to-make-predictions">
<h2>Using a Model to Make Predictions<a class="headerlink" href="#using-a-model-to-make-predictions" title="Permalink to this headline">¶</a></h2>
<p>You can call Rasa NLU directly from your python script. To do so, you need to load the metadata of
your model and instantiate an interpreter. The <code class="docutils literal notranslate"><span class="pre">metadata.json</span></code> in your model dir contains the
necessary information to reconstruct your model:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rasa_nlu.model</span> <span class="kn">import</span> <span class="n">Interpreter</span>

<span class="c1"># where model_directory points to the model folder</span>
<span class="n">interpreter</span> <span class="o">=</span> <span class="n">Interpreter</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">model_directory</span><span class="p">)</span>
</pre></div>
</div>
<p>You can then use the loaded interpreter to parse text:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">interpreter</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;The text I want to understand&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>which returns the same data as the <code class="docutils literal notranslate"><span class="pre">/parse</span></code> endpoint of the <a class="reference internal" href="../http/#section-http"><span class="std std-ref">HTTP API</span></a> .</p>
</div>
<div class="section" id="reducing-memory-use-when-loading-multiple-models">
<h2>Reducing Memory Use When Loading Multiple Models<a class="headerlink" href="#reducing-memory-use-when-loading-multiple-models" title="Permalink to this headline">¶</a></h2>
<p>If multiple models are created, it is reasonable to share components between the different models. E.g.
the <code class="docutils literal notranslate"><span class="pre">'nlp_spacy'</span></code> component, which is used by every pipeline that wants to have access to the spacy word vectors,
can be cached to avoid storing the large word vectors more than once in main memory. To use the caching,
a <code class="docutils literal notranslate"><span class="pre">ComponentBuilder</span></code> should be passed when loading and training models.</p>
<p>Here is a short example on how to create a component builder,
which can be reused to train and run multiple models.
To train a model:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rasa_nlu.training_data</span> <span class="kn">import</span> <span class="n">load_data</span>
<span class="kn">from</span> <span class="nn">rasa_nlu</span> <span class="kn">import</span> <span class="n">config</span>
<span class="kn">from</span> <span class="nn">rasa_nlu.components</span> <span class="kn">import</span> <span class="n">ComponentBuilder</span>
<span class="kn">from</span> <span class="nn">rasa_nlu.model</span> <span class="kn">import</span> <span class="n">Trainer</span>

<span class="n">builder</span> <span class="o">=</span> <span class="n">ComponentBuilder</span><span class="p">(</span><span class="n">use_cache</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>      <span class="c1"># will cache components between pipelines (where possible)</span>

<span class="n">training_data</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="s1">&#39;data/examples/rasa/demo-rasa.json&#39;</span><span class="p">)</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;sample_configs/config_spacy.yml&quot;</span><span class="p">),</span> <span class="n">builder</span><span class="p">)</span>
<span class="n">trainer</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">training_data</span><span class="p">)</span>
<span class="n">model_directory</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">persist</span><span class="p">(</span><span class="s1">&#39;./projects/default/&#39;</span><span class="p">)</span>  <span class="c1"># Returns the directory the model is stored in</span>
</pre></div>
</div>
<p>The same builder can be used to load a model (can be a totally different one). The builder only caches components that are safe to be shared between models. Here is a short example on how to use the builder when loading models:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rasa_nlu.model</span> <span class="kn">import</span> <span class="n">Interpreter</span>
<span class="kn">from</span> <span class="nn">rasa_nlu</span> <span class="kn">import</span> <span class="n">config</span>

<span class="c1"># For simplicity we will load the same model twice, usually you would want to use the metadata of</span>
<span class="c1"># different models</span>

<span class="n">interpreter</span> <span class="o">=</span> <span class="n">Interpreter</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">model_directory</span><span class="p">,</span> <span class="n">builder</span><span class="p">)</span>     <span class="c1"># to use the builder, pass it as an arg when loading the model</span>
<span class="c1"># the clone will share resources with the first model, as long as the same builder is passed!</span>
<span class="n">interpreter_clone</span> <span class="o">=</span> <span class="n">Interpreter</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">model_directory</span><span class="p">,</span> <span class="n">builder</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="important-classes">
<h2>Important Classes<a class="headerlink" href="#important-classes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-rasa_nlu.config">
<span id="config"></span><h3>Config<a class="headerlink" href="#module-rasa_nlu.config" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="rasa_nlu.config.load">
<code class="descclassname">rasa_nlu.config.</code><code class="descname">load</code><span class="sig-paren">(</span><em>filename=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#rasa_nlu.config.load" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="rasa_nlu.config.RasaNLUModelConfig">
<em class="property">class </em><code class="descclassname">rasa_nlu.config.</code><code class="descname">RasaNLUModelConfig</code><span class="sig-paren">(</span><em>configuration_values=None</em><span class="sig-paren">)</span><a class="headerlink" href="#rasa_nlu.config.RasaNLUModelConfig" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="rasa_nlu.config.RasaNLUModelConfig.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>configuration_values=None</em><span class="sig-paren">)</span><a class="headerlink" href="#rasa_nlu.config.RasaNLUModelConfig.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a model configuration, optionally overridding
defaults with a dictionary <code class="docutils literal notranslate"><span class="pre">configuration_values</span></code>.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="interpreter">
<h3>Interpreter<a class="headerlink" href="#interpreter" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="rasa_nlu.model.Interpreter">
<em class="property">class </em><code class="descclassname">rasa_nlu.model.</code><code class="descname">Interpreter</code><span class="sig-paren">(</span><em>pipeline</em>, <em>context</em>, <em>model_metadata=None</em><span class="sig-paren">)</span><a class="headerlink" href="#rasa_nlu.model.Interpreter" title="Permalink to this definition">¶</a></dt>
<dd><p>Use a trained pipeline of components to parse text messages.</p>
<dl class="staticmethod">
<dt id="rasa_nlu.model.Interpreter.load">
<em class="property">static </em><code class="descname">load</code><span class="sig-paren">(</span><em>model_dir</em>, <em>component_builder=None</em>, <em>skip_validation=False</em><span class="sig-paren">)</span><a class="headerlink" href="#rasa_nlu.model.Interpreter.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an interpreter based on a persisted model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>model_dir</strong> (<em>str</em>) – The path of the model to load</li>
<li><strong>component_builder</strong> (<a class="reference internal" href="#rasa_nlu.components.ComponentBuilder" title="rasa_nlu.components.ComponentBuilder"><em>ComponentBuilder</em></a>) – The
<code class="xref py py-class docutils literal notranslate"><span class="pre">ComponentBuilder</span></code> to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">An interpreter that uses the loaded model.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#rasa_nlu.model.Interpreter" title="rasa_nlu.model.Interpreter">Interpreter</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="metadata">
<h3>Metadata<a class="headerlink" href="#metadata" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="rasa_nlu.model.Metadata">
<em class="property">class </em><code class="descclassname">rasa_nlu.model.</code><code class="descname">Metadata</code><span class="sig-paren">(</span><em>metadata</em>, <em>model_dir</em><span class="sig-paren">)</span><a class="headerlink" href="#rasa_nlu.model.Metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Captures all information about a model to load and prepare it.</p>
<dl class="staticmethod">
<dt id="rasa_nlu.model.Metadata.load">
<em class="property">static </em><code class="descname">load</code><span class="sig-paren">(</span><em>model_dir</em><span class="sig-paren">)</span><a class="headerlink" href="#rasa_nlu.model.Metadata.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the metadata from a models directory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>model_dir</strong> (<em>str</em>) – the directory where the model is saved.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A metadata object describing the model</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#rasa_nlu.model.Metadata" title="rasa_nlu.model.Metadata">Metadata</a></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="componentbuilder">
<h3>ComponentBuilder<a class="headerlink" href="#componentbuilder" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="rasa_nlu.components.ComponentBuilder">
<em class="property">class </em><code class="descclassname">rasa_nlu.components.</code><code class="descname">ComponentBuilder</code><span class="sig-paren">(</span><em>use_cache=True</em><span class="sig-paren">)</span><a class="headerlink" href="#rasa_nlu.components.ComponentBuilder" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates trainers and interpreters based on configurations.</p>
<p>Caches components for reuse.</p>
<dl class="method">
<dt id="rasa_nlu.components.ComponentBuilder.load_component">
<code class="descname">load_component</code><span class="sig-paren">(</span><em>component_name</em>, <em>model_dir</em>, <em>model_metadata</em>, <em>**context</em><span class="sig-paren">)</span><a class="headerlink" href="#rasa_nlu.components.ComponentBuilder.load_component" title="Permalink to this definition">¶</a></dt>
<dd><p>Tries to retrieve a component from the cache, else calls
<code class="docutils literal notranslate"><span class="pre">load</span></code> to create a new component.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>component_name</strong> (<em>str</em>) – the name of the component to load</li>
<li><strong>model_dir</strong> (<em>str</em>) – the directory to read the model from</li>
<li><strong>model_metadata</strong> (<a class="reference internal" href="#rasa_nlu.model.Metadata" title="rasa_nlu.model.Metadata"><em>Metadata</em></a>) – the model’s <code class="xref py py-class docutils literal notranslate"><span class="pre">rasa_nlu.models.Metadata</span></code></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">the loaded component.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="../customcomponents/#rasa_nlu.components.Component" title="rasa_nlu.components.Component">Component</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>
</div>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2018, Rasa Technologies GmbH | <a href="https://rasa.com/imprint/" target="_blank">Imprint</a> | <a href="https://rasa.com/privacy-policy/" target="_blank">Privacy Policy</a> 
      

    </div>

    

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async type="opt-in" data-name="googleanalytics" data-type="text/javascript" data-src="https://www.googletagmanager.com/gtag/js?id=UA-87333416-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }
    gtag('js', new Date());
    gtag('config', 'UA-87333416-1', {
      'anonymize_ip': true,
    });
  </script>
  </body>
</html>